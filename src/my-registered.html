<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>My Registered Events — Volunteer Event Registration</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-nav">
    <div class="nav-left">
      <div class="brand-small">Campus Events</div>
      <nav>
        <a href="dashboard.html">Dashboard</a>
        <span style="margin:0 8px;color:#c8cde0">|</span>
        <a href="my-registered.html">My Registered Events</a>
        <span style="margin:0 8px;color:#c8cde0">|</span>
        <a href="create-event.html">Create Event</a>
      </nav>
    </div>
    <div>
      <a id="navLogout" class="btn-ghost">Logout</a>
    </div>
  </header> 

  <main class="page">
    <div class="page-header">
      <div>
        <h1>My Registered Events</h1>
        <div id="subhead" style="color:var(--muted);font-size:13px;margin-top:6px"></div>
      </div>
    </div>

    <section>
      <div id="myGrid" class="events-grid"></div>
    </section>

    <div class="footer">© 2025 Campus Event Registration System</div>
  </main>

  <script>
    (function(){
      const user = requireSession();

      const navMyRegistered = document.getElementById('navMyRegistered');
      const subhead = document.getElementById('subhead');
      const list = document.getElementById('list');

      function render(){
        const events = getEvents();
        const myIds = getMyRegisteredIds(user.id);
        const myEvents = events.filter(e => myIds.has(e.id));

        if(navMyRegistered) navMyRegistered.textContent = `My Registered Events (${myEvents.length})`;
        subhead.textContent = myEvents.length ? `${myEvents.length} registered` : 'No registrations yet';

        list.innerHTML = '';
        if(myEvents.length === 0){
          const empty = document.createElement('div');
          empty.style.gridColumn = '1 / -1';
          empty.style.padding = '14px';
          empty.style.border = '1px solid #eef1f6';
          empty.style.borderRadius = '12px';
          empty.style.background = '#fff';
          empty.style.color = 'var(--muted)';
          empty.textContent = 'You have not registered for any events yet.';
          list.appendChild(empty);
          return;
        }

        myEvents.forEach(ev => {
          const card = document.createElement('div');
          card.className='event-card';

          if(ev.image){
            const img = document.createElement('img');
            img.className='event-thumb';
            img.src = ev.image;
            img.alt='';
            card.appendChild(img);
          } else {
            const ph = document.createElement('div');
            ph.className = 'event-thumb no-image';
            card.appendChild(ph);
          }

          const body = document.createElement('div');
          body.className = 'card-body';

          const title = document.createElement('strong');
          title.textContent = ev.title || 'Untitled event';

          card.appendChild(body);
          grid.appendChild(card);
        });
      }

      document.getElementById('navLogout').addEventListener('click', function(){
        localStorage.removeItem('ers_session');
        window.location='login.html';
      });
    })();
  </script>
</body>
</html>